<!DOCTYPE html>
<html lang="en-GB">

<head>
    <title>Excel Employee Capacity Spreadsheet</title>
    <meta http-equiv="date" content="2023-07-26T10:40:00" />
    <meta http-equiv="last-modified" content="2023-07-26T10:40:00" />
    <meta name="description" content="An Excel spreadsheet for tracking employee utilisation and capacity for project work." />
    <meta name="keyword" content="Excel,spreadsheet,project management,professional services,spreadsheets,employees,utilisation,utilization,capacity" />
    <link rel="stylesheet" href="/highlightjs/styles/github.min.css" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="/highlightjs/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">
    <script src="/highlightjs/highlight.min.js"></script>
    <style>
        figcaption {
            margin-block-start: .7em;
        }
    </style>
</head>

<body>
    <h1 id="top">Excel Employee Capacity Spreadsheet</h1>

    <p>
        Once, when working for a professional-services organisation, I managed a team of business analysts and another team of
        software engineers. As professional-services employees, they were assigned to customer projects, sometimes more
        than one project at a time. Our organisation had KPIs for employee utilisation, so making sure employees were
        assigned to enough projects at the correct level was critical. At the same time, we also needed to reserve
        capacity for upcoming projects.
    </p>

    <p>
        In order to be able to see utilisation and capacity at a glance, and also to be able to report on utilisation for
        montly and quarterly business reviews, I developed an Excel spreadsheet that would display colourful graphs that
        could quickly reveal when employees were over- or under-utilised. It took a bit of Excel
        <a href="https://en.wikipedia.org/wiki/My_kung_fu_is_stronger_than_yours" target="_blank">"kung fu"</a> to accomplish
        this.
    </p>

    <p>
        Since I've left that company, I no longer have that spreadsheet available, so I re-created it to share it here
        and explain the techniques that make it work. In this article, I'll walk the reader through the various worksheets,
        show how they fit together, and explain the formulas, table relationships, and formatting tricks that enable
        the graphical display.
    </p>

    <p>
        If you'd like to follow along, you may
        <a href="https://github.com/paulmooreparks/excel-employee-capacity/raw/main/Employee%20Utilisation.xlsx" target="_blank">download the spreadsheet</a>
        from my <a href="https://github.com/paulmooreparks/excel-employee-capacity/" target="_blank">GitHub repository</a>. The spreadsheet is
        released under an <a href="https://mit-license.org/" target="_blank">MIT License</a>, so please feel free to adapt it to your
        own needs.
    </p>

    <h2 id="at_a_glance">Capacity and Utilisation At a Glance</h2>

    <p>
        In my old job, whenever a new project was confirmed, the project manager would contact the relevant line managers
        about the availability of needed resources. We would then look at how heavily loaded our staff were, and for how
        long they were committed to their current tasks. We needed a way to tell at a glance who was over-committed and
        who had enough slack to take on the assignment. Those where the primary needs that drove the development of the
        spreadsheet.
    </p>

    <p>
        In the figure below, we can see that Louie, a Quality Engineer on the Mighty Ducks team, has at least 75% capacity.
        The rest of the Mighty Ducks team has from 26% to 50% capacity. The Stooges team has quite a bit less capacity. The
        red blocks beside Larry Fine and Moe Howard indicate dates when those employees will be out of office.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png" alt="Employee capacity chart"
            srcset="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/capacity-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/capacity-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee capacity chart</figcaption>
    </figure>

    <p>
        Likewise, when it came time to evaluate where we stood vis-Ã -vis the utilisation metrics, the opposite at-a-glance view
        would be useful to tell us if we were tracking where we needed to or if we needed to find more work.
    </p>

    <p>
        The figure below shows roughly the opposite view as the capacity chart. We now see a red bar next to Louie's name, indicating
        he is critically under-utilised. Curly Joe DeRita is a bit more engaged, and the rest of each team is at least at 50% utilisation.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png" alt="Employee utilisation chart"
            srcset="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/utilisation-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/utilisation-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee utilisation chart</figcaption>
    </figure>

    <p>
        Finally, we needed to be able to account for scheduled time off. Although it was reflected in the capacity chart, it was
        also useful to view time off independently from project assignments.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png" alt="Employee time-off summary chart"
            srcset="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/time-off-summary-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/time-off-summary-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee time-off summary chart</figcaption>
    </figure>

    <h2>Techniques</h2>

    <p>
        There are a few basic techniques in play with this spreadsheet:
        <a href="https://support.microsoft.com/en-us/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c" target="_blank">tables</a>,
        <a href="https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e" target="_blank">structured references</a>,
        <a href="https://support.microsoft.com/en-us/office/xlookup-function-b7fd680e-6d10-43e6-84f9-88eae8bf5929" target="_blank">table lookups</a>,
        <a href="https://support.microsoft.com/en-us/office/names-in-formulas-fc2935f9-115d-4bef-a370-3aa8bb4c91f1" target="_blank">cell/region names</a>,
        <a href="https://support.microsoft.com/en-us/office/apply-data-validation-to-cells-29fecbcc-d1b9-42c1-9d76-eff3ce5f7249" target="_blank">data validation</a>,
        <a href="https://support.microsoft.com/en-us/office/let-function-34842dd8-b92b-4d3f-b325-b8b8f9908999" target="_blank">the LET function</a>,
        and
        <a href="https://support.microsoft.com/en-us/office/use-conditional-formatting-to-highlight-information-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f" target="_blank">conditional formatting</a>
        are the main ones.
    </p>

    <p>
        First of all, any data of consequence is in a table. That's my primary rule for using Excel: If it's tabular data, <em>put it
        into a table!</em> Tables make editing, sorting, filtering, and correlating data vastly easier, and they also discourage some bad
        habits that can quickly make a mess of an otherwise tidy spreadsheet.
    </p>

    <p>
        One big advantage of using tables is that you may use
        <a href="https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e" target="_blank">structured references</a>
        to those tables when writing formulas. This lets you do table lookups, refer to entire columns, filter rows by column data in
        formulas, and so on. You'll see examples of this in the formulas below.
    </p>

    <p>
        The main feature of this spreadsheet, though, is the graphical display of percentages. I use conditional formatting to achieve this
        by setting the text and background colours to the same colour, and varying the colour based on the value of the percentage.
    </p>

    <p>
        Let's walk through all of the supporting tables, then things will make more sense when we get to the complicated formulas.
    </p>

    <h2 id="setup">Set-Up Worksheets</h2>

    <p>
        The spreadsheet runs off of a number of tables, basically like a database. In fact, I'd like to develop a web app
        based on this spreadsheet at some point, but for now it's easy to prototype in Excel.
    </p>

    <h3 id="teams">Teams</h3>

    <p>
        This table lists the names of the teams to which the employees belong. This could also be the names of the managers to which
        the employees report.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-lg.png 118w, /images/excel-employee-capacity-spreadsheet/teams-lg.png 118w, /images/excel-employee-capacity-spreadsheet/teams-lg.png 118w"
            sizes="(max-width: 767px) 118px, (max-width: 991px) 118px, 118px" /></a>
        <figcaption>Teams table</figcaption>
    </figure>

    <p>
        This is also used a data-validation list for the <code>Team</code> column in the
        <a href="#employees"><code>Employees</code></a> table. The way to set this up is to first
        select the column that should serve as a source list.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png 181w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png 181w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png 181w"
            sizes="(max-width: 767px) 181px, (max-width: 991px) 181px, 181px" /></a>
        <figcaption>Select the source column</figcaption>
    </figure>

    <p>
        Next, assign a name to the list. If you add new rows to the table, the list will automatically expand to include those values.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-validation-list-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-validation-list-1-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-validation-list-2-lg.png 303w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-2-md.png 303w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-2-sm.png 200w"
            sizes="(max-width: 767px) 200px, (max-width: 991px) 303px, 303px" /></a>
        <figcaption>Assign a name to the list</figcaption>
    </figure>

    <p>
        Next, select the column in the target table where you want data validation.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-validation-list-3-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-validation-list-3-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-validation-list-3-sm.png 265w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-3-md.png 398w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-3-lg.png 603w"
            sizes="(max-width: 767px) 265px, (max-width: 991px) 398px, 603px" /></a>
        <figcaption>Select the target column</figcaption>
    </figure>

    <p>
        Finally, select the <em>Data Validation</em> command from the <em>Data</em> tab and enable list validation using the list
        name you just created.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-validation-list-4-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-validation-list-4-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-validation-list-4-sm.png 288w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-4-md.png 436w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-4-lg.png 436w"
            sizes="(max-width: 767px) 288px, (max-width: 991px) 436px, 436px" /></a>
        <figcaption>Enable data validation using the named list</figcaption>
    </figure>

    <p>
        Now, when you edit a value in the column, a drop-down tab will appear with values from the validation list. You may also type
        values, but they will be validated against the list.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/teams-validation-list-5-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/teams-validation-list-5-lg.png" alt="Teams table"
            srcset="/images/excel-employee-capacity-spreadsheet/teams-validation-list-5-lg.png 603w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-5-md.png 398w, /images/excel-employee-capacity-spreadsheet/teams-validation-list-5-sm.png 265w"
            sizes="(max-width: 767px) 265px, (max-width: 991px) 398px, 603px" /></a>
        <figcaption>Values are selected from and compared against the list</figcaption>
    </figure>

    <p>
        This is used with several other columns throughout the spreadsheet. I'll call these out where relevant.
    </p>

    <h3 id="roles">Roles</h3>

    <p>
        This table lists the various roles that employees may fill. Usually an employee will have a primary role, but they may also
        step into another role in a project, depending on the need.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/roles-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/roles-lg.png" alt="Roles"
            srcset="/images/excel-employee-capacity-spreadsheet/roles-lg.png 118w, /images/excel-employee-capacity-spreadsheet/roles-lg.png 118w, /images/excel-employee-capacity-spreadsheet/roles-lg.png 118w"
            sizes="(max-width: 767px) 118px, (max-width: 991px) 118px, 118px" /></a>
        <figcaption>Roles table</figcaption>
    </figure>

    <p>
        As with the <a href="#teams"><code>Teams</code></a> list, this is also a data-validation list for the <code>Primary Role</code> column in the
        <a href="#employees"><code>Employees</code></a> table.
    </p>

    <h3 id="employees">Employees</h3>

    <p>
        Now we're getting into the interesting bits. The <code>Employees</code> table contains all of the employees in the organisation
        whose utilisation should be tracked in our spreadsheet.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/employees-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/employees-lg.png" alt="Employees table"
            srcset="/images/excel-employee-capacity-spreadsheet/employees-lg.png 575w, /images/excel-employee-capacity-spreadsheet/employees-md.png 380w, /images/excel-employee-capacity-spreadsheet/employees-sm.png 251w"
            sizes="(max-width: 767px) 251px, (max-width: 991px) 380px, 575px" /></a>
        <figcaption>Employees table</figcaption>
    </figure>

    <p>
        As mentioned earlier, the <code>Primary Role</code> and <code>Team</code> columns are validated against the
        <a href="#roles"><code>Roles</code></a> and <a href="#teams"><code>Teams</code></a> tables.
    </p>

    <p>
        The <code>Primary Role</code> is the role that the employee was hired to fill. It may be possible that an employee could fill
        a different role on a given project, however.
    </p>

    <p>
        The <code>Start Date</code> is the date on which the employee commences work, and the <code>End Date</code> is the date
        when the employee will cease to work (if known). If there is no known end date, this column is blank.
    </p>

    <p>
        The <code>Hours</code> column is the standard number of hours the employee works in a given week.
    </p>

    <h3 id="customers">Customers</h3>

    <p>
        This table is just a list of customers that may have projects running. There could be additional columns in this table
        should you wish to track other details about your customers.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/customers-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/customers-lg.png" alt="Customers table"
            srcset="/images/excel-employee-capacity-spreadsheet/customers-lg.png 111w, /images/excel-employee-capacity-spreadsheet/customers-md.png 111w, /images/excel-employee-capacity-spreadsheet/customers-sm.png 111w"
            sizes="(max-width: 767px) 111px, (max-width: 991px) 111px, 111px" /></a>
        <figcaption>Customers table</figcaption>
    </figure>

    <h2 id="project_details">Project Details</h2>

    <p>
        With all of the basic tables filled, we now move onto the project tables. These tables begin to combine the basic setup tables and
        show some of the special features of this spreadsheet.
    </p>

    <h3 id="projects">Projects</h3>

    <p>
        Now that we have our customer table, we can define the projects we have with those customers and their start and end dates. This
        table will demonstrate how the Gantt-chart representation of dates works.
    </p>

    <p>
        Before we get to the chart portion of the table, we'll quickly cover the left-most data columns. Since we are tracking
        projects by customer, we need to define a unique project name, assign it to a customer, and set the start and end dates
        for the project. The <code>Customer</code> column is validated against the <a href="#customers">Customers</a> table.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/projects-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/projects-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/projects-lg.png 893w, /images/excel-employee-capacity-spreadsheet/projects-md.png 589w, /images/excel-employee-capacity-spreadsheet/projects-sm.png 393w"
            sizes="(max-width: 767px) 393px, (max-width: 991px) 589px, 893px" /></a>
        <figcaption>Project details table</figcaption>
    </figure>

    <p>
        You'll notice the strip of dates above the top of the table that correspond to the beginning of each week. These dates
        drive the graphical chart. The left-most date cell refers to a cell on the "Home" worksheet that is labeled <code>StartDate</code>.
        The spreadsheet user sets this to the date from which the spreadsheet should report its timelines.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/week-start-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/week-start-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/week-start-lg.png 443w, /images/excel-employee-capacity-spreadsheet/week-start-md.png 443w, /images/excel-employee-capacity-spreadsheet/week-start-sm.png 292w"
            sizes="(max-width: 767px) 292px, (max-width: 991px) 443px, 443px" /></a>
        <figcaption>First week marker</figcaption>
    </figure>

    <p>
        Every cell to the right is seven days greater to mark subsequent weeks.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/week-start-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/week-start-2-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/week-start-2-lg.png 443w, /images/excel-employee-capacity-spreadsheet/week-start-2-md.png 443w, /images/excel-employee-capacity-spreadsheet/week-start-2-sm.png 292w"
            sizes="(max-width: 767px) 292px, (max-width: 991px) 443px, 443px" /></a>
        <figcaption>Subsequent week marker</figcaption>
    </figure>

    <p>Next, you'll notice that the current week is highlighted in red, and the current day is bordered in red in all cells below that week.</p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/current-week-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/current-week-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/current-week-lg.png 308w, /images/excel-employee-capacity-spreadsheet/current-week-md.png 308w, /images/excel-employee-capacity-spreadsheet/current-week-sm.png 308w"
            sizes="(max-width: 767px) 308px, (max-width: 991px) 308px, 308px" /></a>
        <figcaption>Day and week highlighting</figcaption>
    </figure>

    <p>
        This is accomplished with <a href="https://support.microsoft.com/en-us/office/use-conditional-formatting-to-highlight-information-fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f" target="_blank">conditional formatting</a>.
        For the weekly cell, this is set up by selecting all the weekly cells across and creating a conditional-formatting rule.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/current-week-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/current-week-2-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/current-week-2-sm.png 369w, /images/excel-employee-capacity-spreadsheet/current-week-2-md.png 553w, /images/excel-employee-capacity-spreadsheet/current-week-2-lg.png 838w"
            sizes="(max-width: 767px) 369px, (max-width: 991px) 553px, 838px" /></a>
        <figcaption>Highlighting the current week</figcaption>
    </figure>

    <p>
        The rule is active for dates occurring in the current week, so the weekly cell that covers the current day will be highlighted with
        a red background and bold white text.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/current-week-3-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/current-week-3-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/current-week-3-sm.png 339w, /images/excel-employee-capacity-spreadsheet/current-week-3-md.png 339w, /images/excel-employee-capacity-spreadsheet/current-week-3-lg.png 514w"
            sizes="(max-width: 767px) 339px, (max-width: 991px) 339px, 514px" /></a>
        <figcaption>Custom format for highlighting the current week</figcaption>
    </figure>

    <p>
        The red borders around the cells in the table for the current day are accomplished similarly, but with a formula. All of the cells
        on row 5 contain a formula that evaluates each cell to a day of the week in the weekly cell above it, but offset for the correct
        day of the week. These cells are then used to control formatting in the table below.
    </p>

    <p>
        Select all of the table cells beneath the date cells and set a conditional-formatting rule that places a red border on
        either side of the cell, with the following formula:
    </p>

    <pre><code class="language-excel">=E$5=TODAY()</code></pre>

    <p>
        Cell <code>E$5</code> is the first date cell, but since the column is relative and the row is absolute the effect is to test
        the date cell directly above each cell being formatted.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/current-day-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/current-day-1-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/current-day-1-lg.png 771w, /images/excel-employee-capacity-spreadsheet/current-day-1-md.png 509w, /images/excel-employee-capacity-spreadsheet/current-day-1-sm.png 339w"
            sizes="(max-width: 767px) 339px, (max-width: 991px) 509px, 771px" /></a>
        <figcaption>Adding red borders around the current day</figcaption>
    </figure>

    <p>
        Finally, there's a bit of a trick to displaying only the initial letter for each day of the week. If you select one of the standard
        date formats, the cell will only show "###" if the column width is too narrow to display the fully formatted date. If you make the
        column too narrow to even display a "#", you'll only see a blank cell.
    </p>

    <p>
        To work around this, we turn again to custom formatting. Select all of the day-of-week cells and create seven more conditional
        formats. Each is driven by a formula. For Mondays...
    </p>

    <pre><code class="language-excel">=WEEKDAY(E$5,2)=1</code></pre>

    <p>
        For Tuesdays...
    </p>

    <pre><code class="language-excel">=WEEKDAY(E$5,2)=2</code></pre>

    <p>
        ...and so on.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/day-of-week-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/day-of-week-1-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/day-of-week-1-sm.png 369w, /images/excel-employee-capacity-spreadsheet/day-of-week-1-md.png 553w, /images/excel-employee-capacity-spreadsheet/day-of-week-1-lg.png 838w"
            sizes="(max-width: 767px) 369px, (max-width: 991px) 553px, 838px" /></a>
        <figcaption>Formatting days of the week</figcaption>
    </figure>

    <p>
        For each day, we set a custom format to display the exact letter desired for that day.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/day-of-week-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/day-of-week-2-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/day-of-week-2-sm.png 339w, /images/excel-employee-capacity-spreadsheet/day-of-week-2-md.png 339w, /images/excel-employee-capacity-spreadsheet/day-of-week-2-lg.png 514w"
            sizes="(max-width: 767px) 339px, (max-width: 991px) 339px, 514px" /></a>
        <figcaption>Using a formula to determine the day of the week</figcaption>
    </figure>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/day-of-week-3-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/day-of-week-3-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/day-of-week-3-sm.png 344w, /images/excel-employee-capacity-spreadsheet/day-of-week-3-md.png 344w, /images/excel-employee-capacity-spreadsheet/day-of-week-3-lg.png 521w"
            sizes="(max-width: 767px) 344px, (max-width: 991px) 344px, 521px" /></a>
        <figcaption>Setting a custom format for each day of the week</figcaption>
    </figure>

    <p>
        With these formats applied all the way across, with a small monospace font and a narrow column width, we're ready to work on the
        body of the Gantt chart.
    </p>

    <p>
        Each cell in the table body underneath the day-of-week columns contains a formula like the one below. In each column, the
        <code>E$5</code> cell reference will change to match the appropriate column, but everything else will remain the same.
    </p>

    <pre><code class="language-excel">=LET(thisDate, E$5,
    IF(
        AND(
            NOT(ISBLANK(ProjectTable[@[Project]:[Project]])),
            ProjectTable[@[End Date]:[End Date]]>=thisDate,
            ProjectTable[@[Start Date]:[Start Date]]<=thisDate
        ),
        1, 0
    )
)</code></pre>

    <p>
        The first thing this formula does is use the
        <a href="https://support.microsoft.com/en-us/office/let-function-34842dd8-b92b-4d3f-b325-b8b8f9908999" target="_blank"><code>LET</code> function</a>
        to assign a name, <code>thisDate</code>, to the evaluation of cell <code>E$5</code> (or the equivalent column).
    </p>

    <pre><code class="language-excel">=LET(thisDate, E$5, </code></pre>

    <p>
        The final parameter to the <code>LET</code> function is the calculation to execute. In this case, it uses the <code>IF</code>
        function to test three different conditions to make sure they are all <code>TRUE</code>. If they are, then it sets a value of
        <code>1</code> in the cell. If any of the values are not <code>TRUE</code>, it sets the cell to <code>0</code>. The first test
        is to check if the <code>Project</code> column in the current row contains a value:
    </p>

    <pre><code class="language-excel">NOT(ISBLANK(ProjectTable[@[Project]:[Project]]))</code></pre>

    <p>
        The next test is whether the date in the <code>End Date</code> column in the current row is greater than or equal to the date
        of the column being evaluated:
    </p>

    <pre><code class="language-excel">ProjectTable[@[End Date]:[End Date]]>=thisDate</code></pre>

    <p>
        The final test is whether the date in the <code>Start Date</code> column in the current row is less than or equal to the date
        of the column being evaluated:
    </p>

    <pre><code class="language-excel">ProjectTable[@[Start Date]:[Start Date]]<=thisDate</code></pre>

    <p>
        If all of the tests are true and the cell evaluates to <code>1</code>, then we want to highlight the cell in dark green
        so that we can see that the project is active on that day. Again, we do this with conditional formatting. If you look
        again at the body of the table, you'll see vertical stripes that mark the weekends.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/projects-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/projects-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/projects-lg.png 893w, /images/excel-employee-capacity-spreadsheet/projects-md.png 589w, /images/excel-employee-capacity-spreadsheet/projects-sm.png 393w"
            sizes="(max-width: 767px) 393px, (max-width: 991px) 589px, 893px" /></a>
        <figcaption>Project details table</figcaption>
    </figure>

    <p>
        To do this, we need two formats for when the cell contains a <code>0</code>: when the date is a weekday, the background will be plain white,
        and when the date is a weekday it will be light grey. When the cell contains a <code>1</code>, the backgrounds are dark green and darker
        green, respectively. We use formulas to determine the appropriate conditional format to use.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-1-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-1-lg.png 838w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-1-md.png 553w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-1-sm.png 369w"
            sizes="(max-width: 767px) 369px, (max-width: 991px) 553px, 838px" /></a>
        <figcaption>Formatting for weekdays and weekends</figcaption>
    </figure>

    <p>
        We also don't want to see "0" or "1" in each of the cells, so we also use a custom format to display a blank value.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-sm.png 344w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-md.png 344w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png 521w"
            sizes="(max-width: 767px) 344px, (max-width: 991px) 344px, 521px" /></a>
        <figcaption>Setting a blank foreground for Gantt-chart cells</figcaption>
    </figure>

    <p>
        Now we have all of the basic tools for creating a date-driven graphical table display. The rest of the worksheets build on the
        same basic formatting, but with percentage ranges rather than "1" or "0".
    </p>

    <h3 id="time_off_detail">Time Off Detail</h3>

    <p>
        Each scheduled instance of time off is recorded in the Time Off Detail worksheet, by employee, listing the start and end date
        of each break. This is used in the <a href="#time_off_summary">Time-off Summary table</a> and in the
        <a href="#capacity">capacity table</a> to show when an employee is unavailable for work. The <code>Employee</code> column is
        validated against the column of the same name in the <a href="#employees">Employees</a> table.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/time-off-detail-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/time-off-detail-lg.png" alt="Employee time-off detail"
            srcset="/images/excel-employee-capacity-spreadsheet/time-off-detail-lg.png 929w, /images/excel-employee-capacity-spreadsheet/time-off-detail-md.png 613w, /images/excel-employee-capacity-spreadsheet/time-off-detail-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee time-off detail</figcaption>
    </figure>

    <p>
        The rest of the worksheet is almost identical in structure to the <a href="#projects">Projects</a> worksheet. The formula
        used in the body of the graphical display differs slightly from the Projects table, in that it reports a percentage value
        from the <code>%</code> column rather than "1".
    </p>

    <pre><code class="language-excel">=LET(thisDate,F$5,
    IF(
        AND(
            NOT(ISBLANK(TimeOffTable[@[Employee]:[Employee]])),
            TimeOffTable[@[End Date]:[End Date]]>=thisDate,
            TimeOffTable[@[Start Date]:[Start Date]]<=thisDate
        ),
        TimeOffTable[@[%]:[%]],0
    )
)</code></pre>

    <p>
        The conditional formatting for the graphical display also changes depending upon the percentage range. For values of 100%,
        the background color will be solid red. For values less than 100%, the background color will be yellow. As in the
        <a href="#projects">Projects</a> table, the weekends will be highlighted in a darker color.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/time-off-detail-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/time-off-detail-1-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/time-off-detail-1-sm.png 369w, /images/excel-employee-capacity-spreadsheet/time-off-detail-1-md.png 553w, /images/excel-employee-capacity-spreadsheet/time-off-detail-1-lg.png 838w"
            sizes="(max-width: 767px) 369px, (max-width: 991px) 553px, 838px" /></a>
        <figcaption>Varying background based on percentages</figcaption>
    </figure>

    <p>
        Each line in the table corresponds to one instance of time off, with a single start date and single end date. These will be
        consolidated in the <a href="#time_off_summary">Time Off Summary</a> worksheet. For example, the four Fridays shown above
        as Annual Leave for Curly Howard will appear as follows in the summary sheet:
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/time-off-summary-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/time-off-summary-2-lg.png" alt="Employee time-off summary showing summarised time-off for Curly Howard"
            srcset="/images/excel-employee-capacity-spreadsheet/time-off-summary-2-lg.png 929w, /images/excel-employee-capacity-spreadsheet/time-off-summary-2-md.png 613w, /images/excel-employee-capacity-spreadsheet/time-off-summary-2-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee time-off summary showing summarised time-off for Curly Howard</figcaption>
    </figure>

    <h3 id="assignments">Assignments</h3>

    <p>
        The Assignments table continues to build on the earlier tables we've discussed. In this table, employees defined in the
        <a href="#employees">Employees</a> table are assigned to projects defined in the <a href="#projects">Projects</a> table.
        Each assignment places an employee into a <a href="#roles">role</a> on a project, with a start and end date and a percentage
        of commitment for the duration of the assignment. The <code>Project</code>, <code>Employee</code>, and <code>Project Role</code>
        columns are all validated against their respective definition tables.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/assignments-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/assignments-lg.png" alt="Project assignments table"
            srcset="/images/excel-employee-capacity-spreadsheet/assignments-lg.png 1165w, /images/excel-employee-capacity-spreadsheet/assignments-md.png 769w, /images/excel-employee-capacity-spreadsheet/assignments-sm.png 513w"
            sizes="(max-width: 767px) 513px, (max-width: 991px) 769px, 1165px" /></a>
        <figcaption>Project assignments table</figcaption>
    </figure>

    <pre><code class="language-excel">=LET(thisDate,L$5,
    IF(
        AND(
            NOT(ISBLANK(AssignmentTable[@[Employee]:[Employee]])),
            AssignmentTable[@[End Date]:[End Date]]>=thisDate,
            AssignmentTable[@[Start Date]:[Start Date]]<=thisDate
        ),
        AssignmentTable[@[%]:[%]],0
    )
)</code></pre>

    <p>
        You may have noticed that the seven right-most columns are all in dark-blue italic text. This is because these columns are
        calculated based on the other columns.
    </p>

    <p>
        The <code>Emp Start Date</code> and <code>Emp End Date</code> columns are read from the <a href="#employees">Employees</a>
        table using the name in the <code>Employee</code> column. This is done with the
        <a href="https://support.microsoft.com/en-us/office/xlookup-function-b7fd680e-6d10-43e6-84f9-88eae8bf5929" target="_blank"><code>XLOOKUP</code></a>
        function.
    </p>

    <pre><code class="language-excel">=XLOOKUP([@Employee],EmployeeTable[Employee],EmployeeTable[Start Date],"")
=XLOOKUP([@Employee],EmployeeTable[Employee],EmployeeTable[End Date],"")</code></pre>

    <p>
        The <code>Customer</code>, <code>Project Start</code>, and <code>Project End</code> columns are looked up in the
        <a href="#projects">Projects</a> table using the value in the <code>Project</code> column.
    </p>

    <pre><code class="language-excel">=XLOOKUP([@Project],ProjectTable[Project],ProjectTable[Customer],"")
=XLOOKUP([@Project],ProjectTable[Project],ProjectTable[Start Date],"")
=XLOOKUP([@Project],ProjectTable[Project],ProjectTable[End Date],"")</code></pre>

    <p>
        Since it is possible that an empty value could be returned from <code>XLOOKUP</code> and displayed as a <code>0</code>,
        we use more conditional formatting so that these values are instead rendered as blanks.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/assignments-1-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/assignments-1-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/assignments-1-sm.png 369w, /images/excel-employee-capacity-spreadsheet/assignments-1-md.png 553w, /images/excel-employee-capacity-spreadsheet/assignments-1-lg.png 838w"
            sizes="(max-width: 767px) 369px, (max-width: 991px) 553px, 838px" /></a>
        <figcaption>Conditional formatting for values of zero</figcaption>
    </figure>

    <p>
        Then, for values of zero, just like in the body of the graphical display we use a custom format of <code>""</code> so that there is
        no value shown in the cell.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png" alt="Project details table"
            srcset="/images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-sm.png 344w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-md.png 344w, /images/excel-employee-capacity-spreadsheet/projects-conditional-formatting-2-lg.png 521w"
            sizes="(max-width: 767px) 344px, (max-width: 991px) 344px, 521px" /></a>
        <figcaption>Setting a blank foreground for Gantt-chart cells</figcaption>
    </figure>

    <h2 id="reporting_worksheets">Reporting Worksheets</h2>

    <p>
        Now that all of the project tables are set up, we can get to the real stars of the spreadsheet, which are the reporting worksheets. These tables use the same
        formatting techniques explained above, so we'll just look at the formulas used in the reporting.
    </p>

    <h3 id="time_off_summary">Time Off Summary</h3>

    <p>
        When assigning staff to projects, it's helpful to see any scheduled time off for each staff member. This table summarises the individual entries in the
        <a href="#time_off_detail">Time Off Detail</a> table to present a consolidated schedule of time off for all staff.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png" alt="Employee time-off summary chart"
            srcset="/images/excel-employee-capacity-spreadsheet/time-off-summary-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/time-off-summary-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/time-off-summary-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee time-off summary chart</figcaption>
    </figure>

    <p>
        The function in each cell of the table performs the following lookups for the employee in the current row to determine the value of the cell:
    </p>

<pre>If employee's employment is terminated...
    Mark the employee as completely unavailable on this date.
Else...
    Find all employee entries in the Time-off Detail table.
    Of those entries, find the entries that begin on or before the date of the current cell.
    Of those entries, find the entries that end on or after the date of the current cell.
    Of those entries, sum the percentage of time off for the current date.</pre>

    <p>
        This logic translates to the following Excel formula placed in each cell of the graphical portion of the table.
        The variables <code>thisDate</code>, <code>employee</code>, <code>endDate</code>, and <code>terminated</code>
        are defined prior to the evaluation of the <code>IF</code> formula.
    </p>

<pre><code class="language-excel">=LET(
    thisDate,D$5,
    employee,TimeOffSummaryTable[@[Employee]:[Employee]],
    endDate,XLOOKUP(employee,EmployeeTable[[Employee]:[Employee]],EmployeeTable[[End Date]:[End Date]],""),
    terminated,IF(OR(endDate=0,endDate>=thisDate),FALSE,TRUE),
    IF(
        terminated,
        1,
        SUM(
            (employee = TimeOffTable[[Employee]:[Employee]]) *
            (thisDate >= TimeOffTable[[Start Date]:[Start Date]]) *
            (thisDate <= TimeOffTable[[End Date]:[End Date]]) *
            (TimeOffTable[[%]:[%]])
        )
    )
)</code></pre>

    <p>
        Any cell containing a percentage of 100% (or greater, if that happens) is shown as a red cell. Percentages
        from 1% to 99% are shown as yellow, and the rest are shown as blank.
    </p>

    <h3 id="utilisation">Utilisation</h3>

    <p>
        The Utilisation table shows how much each employee is being utilised across various projects. This table summarises the <a href="#assigments">Assigment</a>
        table to present the current utilisation for each employee. In this spreadsheet, optimal utilisation is between 75% and 100%. This may vary in other organisations, of course.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png" alt="Employee utilisation chart"
            srcset="/images/excel-employee-capacity-spreadsheet/utilisation-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/utilisation-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/utilisation-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee utilisation chart</figcaption>
    </figure>

    <p>
        The function in each cell of the table performs the following lookups for the employee in the current row to determine the value of the cell:
    </p>

<pre>Find all employee entries in the Assignments table.
Of those entries, find the entries that begin on or before the date of the current cell.
Of those entries, find the entries that end on or after the date of the current cell.
Of those entries, sum the percentage of time assigned for the current date.</pre>

<p>
    This logic translates to the following Excel formula placed in each cell of the graphical portion of the table.
</p>

<pre><code class="language-excel">=LET(
    thisDate,D$5,
    SUM(
        (UtilisationTable[@[Employee]:[Employee]] = AssignmentTable[[Employee]:[Employee]]) *
        (thisDate >= AssignmentTable[[Start Date]:[Start Date]]) *
        (thisDate <= AssignmentTable[[End Date]:[End Date]]) *
        (AssignmentTable[[%]:[%]])
    )
)</code></pre>

    <h3 id="capacity">Capacity</h3>

    <p>
        The Capacity table reports how free each employee is to take on new tasks. This table summarises the
        <a href="#assigments">Assigment</a> table and the <a href="#time_off_detail">Time Off Detail</a> to present the available
        capacity for each employee.
    </p>

    <figure>
        <a href="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png" target="_blank" rel="noopener"><img decoding="async"
            loading="lazy" class="aligncenter" src="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png" alt="Employee capacity chart"
            srcset="/images/excel-employee-capacity-spreadsheet/capacity-chart-lg.png 929w, /images/excel-employee-capacity-spreadsheet/capacity-chart-md.png 613w, /images/excel-employee-capacity-spreadsheet/capacity-chart-sm.png 405w"
            sizes="(max-width: 767px) 405px, (max-width: 991px) 613px, 929px" /></a>
        <figcaption>Employee capacity chart</figcaption>
    </figure>

    <p>
        The function in each cell of the table performs the following lookups for the employee in the current row to determine the value of the cell:
    </p>

<pre>If employee's employment is terminated...
    Mark the employee as completely unavailable on this date.
Else...
    Sum this percentage...
        Find all employee entries in the Assignments table.
        Of those entries, find the entries that begin on or before the date of the current cell.
        Of those entries, find the entries that end on or after the date of the current cell.
        Of those entries, sum the percentage of time assigned for the current date.
    With this percentage...
        Find all employee entries in the Time-off Detail table.
        Of those entries, find the entries that begin on or before the date of the current cell.
        Of those entries, find the entries that end on or after the date of the current cell.
        Of those entries, sum the percentage of time off for the current date.</pre>

    <p>
        This logic translates to the following Excel formula placed in each cell of the graphical portion of the table.
    </p>

<pre><code class="language-excel">=LET(
    thisDate,D$5,
    employee,CapacityTable[@[Employee]:[Employee]],
    endDate,XLOOKUP(employee,EmployeeTable[[Employee]:[Employee]],EmployeeTable[[End Date]:[End Date]],""),
    terminated,IF(OR(endDate=0,endDate>=thisDate),FALSE,TRUE),
    IF(
        terminated,
        1,
        SUM(
            SUM(
                (employee = AssignmentTable[[Employee]:[Employee]]) *
                (thisDate >= AssignmentTable[[Start Date]:[Start Date]]) *
                (thisDate <= AssignmentTable[[End Date]:[End Date]]) *
                (AssignmentTable[[%]:[%]])
            ),
            SUM(
                (employee = TimeOffTable[[Employee]:[Employee]]) *
                (thisDate >= TimeOffTable[[Start Date]:[Start Date]]) *
                (thisDate <= TimeOffTable[[End Date]:[End Date]]) *
                (TimeOffTable[[%]:[%]])
            )
        )
    )
)</code></pre>

<h2 id="summary">Summary</h2>

<p>
    Thanks so much for reading this far. If you have any questions or suggestions, please
    <a href="mailto:paul@parkscomputing.com?subject=Excel%20Employee%20Capacity%20Spreadsheet">send an email</a> and let me know.
</p>

    <script>hljs.highlightAll();</script>
</body>

</html>
